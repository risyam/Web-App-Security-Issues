This repo contains the common web application security vulnerabilties, the ways to exploit the same and the possible remediations
* Authorization Framework
* Enables web applications to request limited access  to a user's account on other application
* Allows the user to grant access without exposing their login credentials to the requesting application
* No need t hand over full control of their account to a third party
* Common Usage:
 To integrate third party functionality that requires access to certain data from a user's account
 Eg. Request access to email contacts alone
* However, same mechanism is also used to provide **third party authentication services**, allowing users to login with an account that they have with a different website
## How does OAuth 2.0 work
* By a series of interaction between three parties:
  1. Client Application
  2. Resource Owner
  3. OAuth Service provider

### Client Application:
* The website that wants to access the user's data
### Resource Owner
* User whose data needs to be accessed
### OAuth Service Provider
* Application that controls user's data (Eg. Gmail)
### Steps:
1. Client application requests access to a subset of user's data, specifying:
   * Which **grant type** they want to use
   * What kind of access they want (**scope**)
2.  The user is prompted to lo g into the OAuth service and explicitly give their consent for the requested access
3. The client application receives a unique access token
4. The client application uses this access tokens to make API calls fetching relevant data from the resource owner

### OAuth grant types
* Determines the exact sequence of steps that are involved in the OAuth process
* Also knowns as **OAuth flows**
* Types:
  * Authorization code
  * Implicit
  * Client credentials
  * Device code
  * Refresh Token
  * PKCE (Proof Key for Code Exchange)- 'pixie'
### OAuth scopes
* Specifies **which data** it wants to access and **what kind of operation** it wants to perform
* Using **scope parameters**
* Unique to each OAuth service:
Eg: 
   * scope= contacts
   * scope= contacts.read
   * scope= contact-list-r
* **_When OAuth is used for authentication, OpenID connect scopes are often used_**

### Authorization code grant type

![image](https://user-images.githubusercontent.com/99638640/172089102-cec1bd25-1ecf-4a09-ad95-d0cfefdb83f2.png)
 
  _Image is taken from: https://portswigger.net/web-security/oauth/grant-types_

* Al communication that takes place  from code/token exchange onward (from step 4) is sent **server-to-server** over a **secure**, **pre-configured back channel** and is **invisible to the end user**
* The secure channel is established, when the client application first registers with the OAuth service
* **A client secret is also generated at this time (first registration), which should be used for all server-to-server requests**

### Implicit grant type

![image](https://user-images.githubusercontent.com/99638640/172089893-7738a6cb-7fa9-443e-adbc-7be951071bed.png)

  _Image is taken from : https://portswigger.net/web-security/oauth/grant-types_

### Difference between Implicit and Authorization Code Grant Type
* In Implicit, no step to get authorization code
* Client application receives access token immediately after the user gives the consent- > **makes it simple**
* Implicit is less secure:
   * All communication happens via browser
   * No secure back-channel, server-to-server communication
*  _**Implicit is more suitable for single page applications and native desktop applications, which cannot easily store the client-secret on back end**_

### OAuth Authentication
* Basic OAuth flows remain the same
* Difference is **how the application uses the data that it receives**
* Steps:
   1. The user chooses the option to login with FB/Gmail
   2. The client application uses the FB'/Gmail's OAuth service to request access to some data that it can use to identify the user
      Eg. Email address
   3. After receiving an access token, the client application requests this data from the resource owner
   4. Once the data is received, the client application uses it in place of a username to log the user in (Access token can be used in place of the password)

## Exploiting OAuth Authentication Vulnerabilities
### 1. Vulnerabilities in the OAuth client application
      
1. Improper implementation of the implicit grant type
* Access token is sent from the OAuth service to the client application via user's browser as a URL fragment
* The client application then access the token using JavaScript
* If the client application wants to maintain the session after the user closes the page, it needs to store the current user data somewhere (User ID and Access Token)
* To solve this, the client application will often submit this data to the server in a **post request** and then **assign the user a session cookie**, effectively logging them in
* **Issue**:
  Server does not have any secrets or passwords to compare with submitted data => Implicitly trusted
* This post request is exposed to attackers via their browsers. As a result, _a vulnerability is possible if the client application doesn't properly check that the access token matches the other data in the request_

